'use strict';

class DailyReport{

  constructor(){
    this.date = new Date();
    this.grade = "";
    this.subject = "";
    this.students = []
    this.contents = [{}]
    this.homeworks = [{}]
    this.test_result_pics = []
    this.test_result_pic_data_list =[""]
    this.blackboard_pics = []
    this.blackboard_pic_data_list =[""]

    this.note = ""
  }
}

angular.module('cram.daily_reports')
  .controller('DailyReportsController', ['$scope', '$http', '$window', 'Student', 'Textbook', function($scope, $http, $window, Student, Textbook){
    $scope.daily_report = new DailyReport();
    $scope.daily_report.students = Student.query();

    $scope.grade_list = ["小１", "小２", "小３", "小４", "小５", "小６", "中１", "中２", "中３", "高１", "高２", "高３"];
    $scope.subject_list = ["英語", "数学", "算数", "理科", "国語"]

    $scope.textbooks = Textbook.query();

    $scope.add_content = function(){
      $scope.daily_report.contents.push({})
    }

    $scope.delete_content = function(i) {
      $scope.daily_report.contents.splice(i, 1);
    }

    // $scope.add_blackboard_pic_data = function(){
    //   $scope.daily_report.blackboard_pic_data_list.push({})
    // }
    //
    // $scope.delete_blackboad_pic_data = function(i){
    //   $scope.daily_report.blackboard_pic_data_list.splice(i, 1);
    // }
    //
    // $scope.add_test_result_pic_data = function(){
    //   $scope.daily_report.test_result_pic_data_list.push({});
    // }
    //
    // $scope.delete_test_result_pic_data = function(i){
    //   $scope.daily_report.test_result_pic_data_list.splice(i, 1);
    // }

    $scope.add_homework = function(){
      $scope.daily_report.homeworks.push({});
    }

    $scope.delete_homework = function(i){
      $scope.daily_report.homeworks.splice(i, 1);
    }

    $scope.submit = function(){
      $http({
        method: 'POST',
        url: '/api/daily_reports',
        data: {"daily_report": $scope.daily_report}
      }).success(function(data, status, headers, config){
        $window.location.href = `/admin/daily_reports/${data['id']}`;
      }).error(function(data, status, headers, config){
        console.log(data);
      });
    }
  }]);
